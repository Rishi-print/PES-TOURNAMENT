<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SHOSTA PES Tournament</title>
  <style>

/* Podium / Winners display */
.podium {
  max-width: 900px;
  margin: 24px auto;
  display: grid;
  gap: 12px;
}
.podium-card {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px 18px;
  border-radius: 14px;
  font-weight: 800;
  text-shadow: 0 1px 2px rgba(0,0,0,.35);
  letter-spacing: .5px;
}
.podium-card .label { opacity: .9; }
.podium-card .name { font-size: 1.3rem; }

.podium-card.gold {
  background: linear-gradient(135deg,#d4af37,#ffdf6b);
  color: #2b1f00;
  box-shadow: 0 0 12px rgba(255,215,0,.6);
}
.podium-card.silver {
  background: linear-gradient(135deg,#cfd6e6,#eaeef6);
  color: #1f2430;
  box-shadow: 0 0 12px rgba(176,196,222,.5);
}
.podium-card.bronze {
  background: linear-gradient(135deg,#cd7f32,#e0a371);
  color: #2b1a0a;
  box-shadow: 0 0 12px rgba(205,127,50,.55);
}


/* Special Start Tournament button */
.start-btn {
margin-top: 25px;
  display: inline-block;
  background: linear-gradient(135deg, #ffd700, #ff8c00); /* golden glow */
  color: black;
  font-size: 1.4rem;
  font-weight: 800;
  padding: 16px 40px;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 140, 0, 0.6);
  text-transform: uppercase;
  letter-spacing: 2px;
  transition: transform 0.2s ease, box-shadow 0.3s ease;
  animation: pulse 1.8s infinite;
}

.start-btn:hover {
  transform: scale(1.08);
  box-shadow: 0 0 30px rgba(255, 215, 0, 1), 0 0 60px rgba(255, 140, 0, 0.9);
}

/* Pulse animation */
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}


/* ===== SINGLE BACKGROUND IMAGE ===== */
body::before {
  content: "";
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: url('yourimage.jpg') no-repeat center center / cover;
  filter: blur(1px) brightness(1); /* blur + darken */
  z-index: -2;
}

/* Overlay (extra dim layer to ensure text is readable) */
body::after {
  content: "";
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0.5); 
  z-index: -1;
}


.rules-btn {
  display: inline-block;
  background-color: #008000;   /* green like your other buttons */
  color: white;                /* white font */
  font-weight: 600;
  font-size: 16px;
  padding: 10px 18px;
  border-radius: 8px;
  text-decoration: none;       /* removes underline */
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
  transition: background-color 0.3s ease, transform 0.2s ease;
}

.rules-btn:hover {
  background-color: #006400;   /* darker green on hover */
  transform: scale(1.05);      /* slight zoom */
}

    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to bottom, #1a472a, #0b2415); /* football pitch vibe */
      color: #f5f5f5;
      margin: 0;
      padding: 20px;
      text-align: center;
      line-height: 1.6;
    }

    h1 {
      color: #ffd700;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.7);
    }

    h2, h3 {
      color: #ffd700; /* trophy gold */
      text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
      margin-bottom: 15px;
      margin-top: 25px;
      font-weight: 700;
    }

    button {
      background-color: #006400;
      color: white;
      border: none;
      padding: 10px 16px;
      margin: 8px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.95rem;
      box-shadow: 0 3px 6px rgba(0,0,0,0.25);
      transition: 0.2s;
    }

    button:hover {
      background-color: #228b22;
      transform: translateY(-2px);
    }

    button#resetBtn {
      background-color: #b22222;
    }

    #setup, #schedule {
      background: rgba(0, 0, 0, 0.65);
      padding: 20px;
      border-radius: 14px;
      margin: 20px auto;
      max-width: 900px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }

    input, select {
      padding: 8px 10px;
      border-radius: 6px;
      border: none;
      margin: 8px;
      font-size: 0.9rem;
    }

    #matches, #semis, #finals {
      margin-top: 20px;
    }

    .match {
      background: rgba(34, 139, 34, 0.85); /* semi-transparent grass */
      padding: 12px;
      border-radius: 10px;
      margin: 12px auto;
      max-width: 480px;
      border: 2px solid white;
      font-size: 0.95rem;
      font-weight: 500;
    }

    .match b {
      color: #ffd700;
    }

    /* Scoreboard-style Table */
    table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 95%;
      max-width: 900px;
      background: #013220; /* dark turf green */
      color: white;
      box-shadow: 0 0 12px rgba(0,0,0,0.5);
      border-radius: 12px;
      overflow: hidden;
    }

    table th {
      background: repeating-linear-gradient(
        45deg,
        #004d00,
        #004d00 10px,
        #006400 10px,
        #006400 20px
      ); /* striped effect */
      color: #ffd700;
      padding: 14px 10px;
      border: 1px solid #fff;
      text-transform: uppercase;
      font-size: 0.85rem;
      letter-spacing: 1px;
      font-weight: 700;
      position: relative;
    }

    table th::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(to bottom, rgba(255,255,255,0.25), transparent);
      pointer-events: none;
    }

    table td {
      padding: 12px 8px;
      border: 1px solid #fff;
      font-size: 0.9rem;
      text-align: center;
      font-weight: 600;
    }

    /* Knockout Rounds - Semi & Final */
    #semiFinals .match, #finals .match {
      background: rgba(0,0,0,0.75);
      border: 3px solid #ffd700; /* gold frame */
      box-shadow: 0 0 10px rgba(255,215,0,0.6), 0 0 20px rgba(255,215,0,0.4);
      font-size: 1rem;
      font-weight: 700;
      color: #f5f5f5;
      max-width: 500px;
      margin-top: 25px;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      table, th, td {
        font-size: 0.8rem;
      }

      button {
        width: 90%;
        margin: 8px auto;
        display: block;
      }

      .match {
        width: 95%;
        font-size: 0.85rem;
      }
    }

    @media (max-width: 480px) {
      h2, h3 {
        font-size: 1.2rem;
      }

      table, th, td {
        font-size: 0.75rem;
      }

      input, select {
        width: 90%;
        margin: 6px auto;
        display: block;
      }
    }
    .hidden {display:none!important;}
  </style>
</head>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>


<body>
<body class="bg-green-900 text-white font-sans">

  <!-- Navigation Buttons at the Top -->
  <div class="text-center my-4 space-x-2">
    <a href="Rules.html" class="rules-btn">
       ‚öñÔ∏è Tournament Rules
    </a>
    <a href="format.html" class="rules-btn" style="background-color:#1e90ff;">
       üìä Tournament Format
    </a>
  </div>

  <!-- Your tournament code starts here -->

  <h1>PES Tournament</h1>
  <div id="setup">
    <label>Number of Players:</label>
    <input type="number" id="numPlayers" min="2">
    <button onclick="addPlayerInputs()">Add Player Inputs</button>
    <div id="playerInputs"></div>
    <button class="start-btn" onclick="startTournament()">üöÄ Start Tournament</button>

  </div>

  <div id="schedule" class="hidden">
    <h2>Round Robin Matches</h2>
    <div id="matches"></div>
    <h2>Standings</h2>
    <table id="standingsTable">
      <thead>
        <tr>
          <th>Player</th>
          <th>Played</th>
          <th>Won</th>
          <th>Draw</th>
          <th>Lost</th>
          <th>GF</th>
          <th>GA</th>
          <th>GD</th>
          <th>Points</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <h2>Semi-Finals</h2>
    <div id="semiFinals"></div>
    <h2>Final</h2>
    <div id="final"></div>
    <h2>Third Place</h2>
    <div id="thirdPlace"></div>

<!-- Winners / Podium -->
<h2 style="margin-top:28px;">Winners</h2>
<div id="winners" class="podium hidden">
  <div class="podium-card gold">
    <span class="label">ü•á Winner:</span>
    <span id="winnerName" class="name">TBD</span>
  </div>
  <div class="podium-card silver">
    <span class="label">ü•à Finalist:</span>
    <span id="finalistName" class="name">TBD</span>
  </div>
  <div class="podium-card bronze">
    <span class="label">ü•â Third Place:</span>
    <span id="thirdName" class="name">TBD</span>
  </div>
</div>


    <br>
    <button id="resetBtn" class="hidden">Reset Tournament</button>
  </div>

<script>
const $ = id => document.querySelector(id);

let players = [];
let matches = [];
let standings = {};
let semiPairs = [];
let semiWinners = [null, null];
let semiLosers = [null, null];
let finalPair = null;
let thirdPair = null;
let finalWinner = null;
let finalist = null;
let thirdWinner = null;


function addPlayerInputs() {
  const n = parseInt($("#numPlayers").value);
  const container = $("#playerInputs");
  container.innerHTML = "";
  for (let i=0;i<n;i++) {
    container.innerHTML += `<input type="text" id="p${i}" placeholder="Player ${i+1}"><br>`;
  }
}

function startTournament() {
  players = [];
  const n = parseInt($("#numPlayers").value);
  for (let i=0;i<n;i++) {
    const name = $(`#p${i}`).value.trim() || `Player${i+1}`;
    players.push(name);
  }
  matches = [];
  standings = {};
  players.forEach(p => standings[p] = {played:0, won:0, draw:0, lost:0, gf:0, ga:0, gd:0, points:0});
  for (let i=0;i<players.length;i++) {
    for (let j=i+1;j<players.length;j++) {
      matches.push({h: players[i], a: players[j], hg:null, ag:null});
    }
  }
  $("#setup").classList.add("hidden");
  $("#schedule").classList.remove("hidden");
  $("#resetBtn").classList.remove("hidden");
  renderMatches();
  updateTable();
  saveState();
}

function renderMatches() {
  const list = $("#matches");
  list.innerHTML = "";
  matches.forEach((m, idx) => {
    const row = document.createElement("div");
    row.className = "match";
    row.innerHTML = `
      <div><b>${m.h}</b> vs <b>${m.a}</b></div>
      <div>
        <input type="number" min="0" value="${m.hg!==null?m.hg:""}" 
          onchange="recordScore(${idx}, this.value, 'H')" placeholder="Goals ${m.h}">
        -
        <input type="number" min="0" value="${m.ag!==null?m.ag:""}" 
          onchange="recordScore(${idx}, this.value, 'A')" placeholder="Goals ${m.a}">
      </div>`;
    list.appendChild(row);
  });
}

function recordScore(idx, val, side) {
  if(side==="H") matches[idx].hg = val===""?null:parseInt(val);
  else matches[idx].ag = val===""?null:parseInt(val);
  recomputeStandings();
  updateTable();
  if (matches.every(m=>m.hg!==null && m.ag!==null)) {
    setupSemis();
  }
  saveState();
}

function recomputeStandings() {
  players.forEach(p => standings[p] = {played:0, won:0, draw:0, lost:0, gf:0, ga:0, gd:0, points:0});
  matches.forEach(m => {
    if (m.hg===null || m.ag===null) return;
    standings[m.h].played++;
    standings[m.a].played++;
    standings[m.h].gf += m.hg;
    standings[m.h].ga += m.ag;
    standings[m.a].gf += m.ag;
    standings[m.a].ga += m.hg;
    if (m.hg>m.ag) {
      standings[m.h].won++; standings[m.h].points+=3; standings[m.a].lost++;
    } else if (m.ag>m.hg) {
      standings[m.a].won++; standings[m.a].points+=3; standings[m.h].lost++;
    } else {
      standings[m.h].draw++; standings[m.h].points++; standings[m.a].draw++; standings[m.a].points++;
    }
  });
  players.forEach(p=>standings[p].gd=standings[p].gf-standings[p].ga);
}

function updateTable() {
  const body = $("#standingsTable tbody");
  body.innerHTML = "";
  Object.entries(standings)
    .sort((a,b)=>{
      if(b[1].points!==a[1].points) return b[1].points - a[1].points;
      if(b[1].gd!==a[1].gd) return b[1].gd - a[1].gd;
      if(b[1].gf!==a[1].gf) return b[1].gf - a[1].gf;
      return a[0].localeCompare(b[0]);
    })
    .forEach(([p,s])=>{
      body.innerHTML += `<tr>
        <td>${p}</td>
        <td>${s.played}</td>
        <td>${s.won}</td>
        <td>${s.draw}</td>
        <td>${s.lost}</td>
        <td>${s.gf}</td>
        <td>${s.ga}</td>
        <td>${s.gd}</td>
        <td>${s.points}</td>
      </tr>`;
    });
}

function setupSemis() {
  const sorted = Object.entries(standings).sort((a,b)=>{
    if(b[1].points!==a[1].points) return b[1].points - a[1].points;
    if(b[1].gd!==a[1].gd) return b[1].gd - a[1].gd;
    if(b[1].gf!==a[1].gf) return b[1].gf - a[1].gf;
    return a[0].localeCompare(b[0]);
  });
  const top4 = sorted.slice(0,4).map(x=>x[0]);
  if(top4.length<4) return;
  semiPairs = [[top4[0],top4[3]],[top4[1],top4[2]]];
  showSemiFinals();
}

function showSemiFinals() {
  const div = $("#semiFinals");
  div.innerHTML = "";
  semiPairs.forEach((pair,i)=>{
    div.innerHTML += `
      <div class="match">${pair[0]} vs ${pair[1]}
        <select onchange="recordSemiResult(${i}, this.value)">
          <option value="">Result</option>
          <option value="${pair[0]}" ${semiWinners[i]===pair[0]?"selected":""}>${pair[0]} Win</option>
          <option value="${pair[1]}" ${semiWinners[i]===pair[1]?"selected":""}>${pair[1]} Win</option>
        </select>
      </div>`;
  });
}

function recordSemiResult(idx, winner) {
  semiWinners[idx] = winner;
  semiLosers[idx] = semiPairs[idx].find(p=>p!==winner);
  if (semiWinners.every(x=>x)) {
    finalPair = [semiWinners[0],semiWinners[1]];
    thirdPair = [semiLosers[0],semiLosers[1]];
    showFinalAndThird();
  }
  saveState();
}

function showFinalAndThird() {
  $("#final").innerHTML = `${finalPair[0]} vs ${finalPair[1]} 
    <select onchange="recordFinal(this.value)">
      <option value="">Result</option>
      <option value="${finalPair[0]}" ${finalWinner===finalPair[0]?"selected":""}>${finalPair[0]} Win</option>
      <option value="${finalPair[1]}" ${finalWinner===finalPair[1]?"selected":""}>${finalPair[1]} Win</option>
    </select>`;

  $("#thirdPlace").innerHTML = `${thirdPair[0]} vs ${thirdPair[1]} 
    <select onchange="recordThird(this.value)">
      <option value="">Result</option>
      <option value="${thirdPair[0]}" ${thirdWinner===thirdPair[0]?"selected":""}>${thirdPair[0]} Win</option>
      <option value="${thirdPair[1]}" ${thirdWinner===thirdPair[1]?"selected":""}>${thirdPair[1]} Win</option>
    </select>`;
}

function recordFinal(winner) {
  if (!winner) return;
  finalWinner = winner;
  finalist = finalPair.find(p => p !== winner);
  updatePodium();
  saveState();
}

function recordThird(winner) {
  if (!winner) return;
  thirdWinner = winner;
  updatePodium();
  saveState();
}


function updatePodium() {
  if (finalWinner) $("#winnerName").textContent = finalWinner;
  if (finalist) $("#finalistName").textContent = finalist;
  if (thirdWinner) $("#thirdName").textContent = thirdWinner;

  // Show the podium once both final winner and third place are decided
  if (finalWinner && thirdWinner) {
    $("#winners").classList.remove("hidden");

    // üéâ Confetti Celebration üéâ
    launchConfetti();
  }
}

// Function to fire confetti
function launchConfetti() {
  // Duration of celebration
  const duration = 3 * 1000; // 3 seconds
  const end = Date.now() + duration;

  (function frame() {
    // Confetti settings
    confetti({
      particleCount: 5,
      angle: 60,
      spread: 55,
      origin: { x: 0 },
    });
    confetti({
      particleCount: 5,
      angle: 120,
      spread: 55,
      origin: { x: 1 },
    });

    // Keep going until duration is over
    if (Date.now() < end) {
      requestAnimationFrame(frame);
    }
  })();
}


function saveState() {
  const state = { 
    players,matches,standings,semiPairs,semiWinners,semiLosers,finalPair,thirdPair,
    finalWinner, finalist, thirdWinner
  };
  localStorage.setItem("tournamentData", JSON.stringify(state));
}


function loadState() {
  const saved = localStorage.getItem("tournamentData");
  if (!saved) return;
  const state = JSON.parse(saved);
  players = state.players||[];
  matches = state.matches||[];
  standings = state.standings||{};
  semiPairs = state.semiPairs||[];
  semiWinners = state.semiWinners||[null,null];
  semiLosers = state.semiLosers||[null,null];
  finalPair = state.finalPair||null;
  thirdPair = state.thirdPair||null;
  finalWinner = state.finalWinner || null;
  finalist = state.finalist || null;
  thirdWinner = state.thirdWinner || null;

  if (players.length) {
    $("#setup").classList.add("hidden");
    $("#schedule").classList.remove("hidden");
    $("#resetBtn").classList.remove("hidden");
    renderMatches();
    recomputeStandings();
    updateTable();
    if (semiPairs.length) showSemiFinals();
    if (finalPair) showFinalAndThird();
    updatePodium();
  }
}

$("#resetBtn").addEventListener("click", () => {
  if (confirm("Reset tournament?")) {
    localStorage.removeItem("tournamentData");
    location.reload();
  }
});

window.addEventListener("load", loadState);
</script>
</body>
</html>
